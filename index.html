<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DISCOUNT HUNTER</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-content">
          <h1>DISCOUNT HUNTER</h1>
          <div class="auth-buttons">
            <span id="userEmail" class="user-email"></span>
            <button id="loginButton" class="auth-button">登錄</button>
            <button id="logoutButton" class="auth-button hidden">登出</button>
          </div>
        </div>
        <div class="header-right">
          <div class="search-container">
            <input type="text" id="searchInput" placeholder="搜尋優惠..." />
            <div class="search-buttons">
              <button id="searchButton">搜尋</button>
              <button id="filterButton" class="filter-button">
                <i class="fas fa-filter"></i>
              </button>
            </div>
          </div>
          <div class="sort-container">
            <select id="sortBy">
              <option value="newest">最新優惠</option>
              <option value="price-asc">價格由低到高</option>
              <option value="price-desc">價格由高到低</option>
              <option value="popular">最受歡迎</option>
            </select>
          </div>
          <a href="add-discount.html" class="add-button" title="新增優惠">
            <i class="fas fa-plus"></i>
          </a>
        </div>
      </header>

      <!-- 篩選面板 -->
      <div id="filterPanel" class="filter-panel hidden">
        <div class="filter-container">
          <div class="filter-group">
            <label for="keywordInput">類別：</label>
            <div class="keyword-input-container">
              <input
                type="text"
                id="keywordInput"
                placeholder="例：餐廳、信用卡折扣、電影票、購物優惠"
              />
              <div id="keywordList" class="keyword-list"></div>
            </div>
          </div>
          <div class="filter-group">
            <label for="areaInput">地區：</label>
            <div class="keyword-input-container">
              <input
                type="text"
                id="areaInput"
                placeholder="例：台北市大安區、新北市板橋區、桃園市中壢區"
              />
              <div id="areaList" class="keyword-list"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="searchResults" class="search-results">
        <h2 class="section-title">熱門優惠</h2>
        <!-- 預設搜尋結果 -->
        <a href="discount-detail.html" class="discount-card">
          <div class="discount-header">
            <span class="discount-tag">限時優惠</span>
            <span class="discount-date">2024/03/30</span>
          </div>
          <div class="discount-content">
            <h3 class="discount-title">星巴克買一送一</h3>
            <p class="discount-description">
              全台星巴克門市，指定飲品買一送一，限時3天
            </p>
            <div class="discount-footer">
              <span class="discount-location"
                ><i class="fas fa-map-marker-alt"></i> 全台門市</span
              >
              <span class="discount-category"
                ><i class="fas fa-tag"></i> 飲品</span
              >
            </div>
          </div>
        </a>

        <a href="discount-detail.html" class="discount-card">
          <div class="discount-header">
            <span class="discount-tag">信用卡優惠</span>
            <span class="discount-date">2024/03/31</span>
          </div>
          <div class="discount-content">
            <h3 class="discount-title">國泰世華卡友專屬優惠</h3>
            <p class="discount-description">
              使用國泰世華信用卡，全台餐廳消費享85折優惠
            </p>
            <div class="discount-footer">
              <span class="discount-location"
                ><i class="fas fa-map-marker-alt"></i> 全台餐廳</span
              >
              <span class="discount-category"
                ><i class="fas fa-credit-card"></i> 信用卡</span
              >
            </div>
          </div>
        </a>

        <a href="discount-detail.html" class="discount-card">
          <div class="discount-header">
            <span class="discount-tag">購物優惠</span>
            <span class="discount-date">2024/04/01</span>
          </div>
          <div class="discount-content">
            <h3 class="discount-title">全聯福利中心週年慶</h3>
            <p class="discount-description">
              全聯福利中心週年慶，全館商品第二件半價
            </p>
            <div class="discount-footer">
              <span class="discount-location"
                ><i class="fas fa-map-marker-alt"></i> 全台門市</span
              >
              <span class="discount-category"
                ><i class="fas fa-shopping-cart"></i> 購物</span
              >
            </div>
          </div>
        </a>
      </div>
    </div>

    <script src="script.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-analytics-compat.js"></script>
    <script>
      // Firebase 配置
      const firebaseConfig = {
        apiKey: "AIzaSyBbMs3BgV5QZEXLU91KeKj9mQj1vd5PwTM",
        authDomain: "discount-hunter-733a8.firebaseapp.com",
        projectId: "discount-hunter-733a8",
        storageBucket: "discount-hunter-733a8.firebasestorage.app",
        messagingSenderId: "774607292140",
        appId: "1:774607292140:web:9dcc71a4592bb76ee9c7c9",
        measurementId: "G-35Y27JMY5F",
        databaseURL:
          "https://discount-hunter-733a8-default-rtdb.firebaseio.com",
      };

      // 初始化 Firebase
      firebase.initializeApp(firebaseConfig);
      const analytics = firebase.analytics();

      // 監聽登錄狀態變化
      auth.onAuthStateChanged((user) => {
        const loginButton = document.getElementById("loginButton");
        const logoutButton = document.getElementById("logoutButton");
        const userEmail = document.getElementById("userEmail");

        if (user) {
          loginButton.classList.add("hidden");
          logoutButton.classList.remove("hidden");
          userEmail.textContent = user.email;
        } else {
          loginButton.classList.remove("hidden");
          logoutButton.classList.add("hidden");
          userEmail.textContent = "";
        }
      });

      // 登錄按鈕點擊事件
      document.getElementById("loginButton").addEventListener("click", () => {
        window.location.href = "login.html";
      });

      // 登出按鈕點擊事件
      document
        .getElementById("logoutButton")
        .addEventListener("click", async () => {
          try {
            await auth.signOut();
            window.location.reload();
          } catch (error) {
            console.error("登出錯誤:", error);
            alert("登出失敗：" + error.message);
          }
        });
    </script>
  </body>
</html>
